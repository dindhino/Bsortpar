from mpi4py import MPI
import time

def mergeSort(tubes):
    if len(tubes)>1:
        mid = len(tubes)//2
        left = tubes[:mid]
        right = tubes[mid:]

        mergeSort(left)
        mergeSort(right)

        i=0
        j=0
        k=0
        while i < len(left) and j < len(right):
            if left[i] < right[j]:
                tubes[k]=left[i]
                i=i+1
            else:
                tubes[k]=right[j]
                j=j+1
            k=k+1

        while i < len(left):
            tubes[k]=left[i]
            i=i+1
            k=k+1

        while j < len(right):
            tubes[k]=right[j]
            j=j+1
            k=k+1

def bubblesort(rk):
    for length in range(len(rk)-1,0,-1):
        for i in range(length):
            if rk[i]>rk[i+1]:
               temp = rk[i]
               rk[i] = rk[i+1]
               rk[i+1] = temp

#tools untuk mpi
comm = MPI.COMM_WORLD
rank = comm.Get_rank()
size = comm.Get_size()

#menghitung waktu
start = time.time()

#memasukan dataset

if rank==0:
    hasil = []
    #memasukan semua rk dari rank 1-4 ke dalam satu array
    for i in range (1,size):
	rk = comm.recv(source=i)
	for j in range(0,len(rk)):
	    hasil.append(rk[j])

    #merge sort si hasil
    mergeSort(hasil)
    print "array hasil dibawah ini: "
    print (hasil)

    print ("===================================================================")
    end = time.time()
    print "start time: {}".format(start)
    print "end time: {}".format(end)
    print "waktu running: {} ".format(end-start)
    
else:
#rk = array tiap baris
	if rank == 1:
		rk = []
		rk.append(143)
		rk.append(586)
		rk.append(873)
		rk.append(502)
		rk.append(410)
		rk.append(954)
		rk.append(219)
		rk.append(965)
		rk.append(372)
		rk.append(472)
		rk.append(617)
		rk.append(975)
		rk.append(515)
		rk.append(531)
		rk.append(265)
		rk.append(238)
		rk.append(145)
		rk.append(458)
		rk.append(973)
		rk.append(597)
		rk.append(149)
		rk.append(290)
		rk.append(267)
		rk.append(880)
		rk.append(714)
		rk.append(516)
		rk.append(202)
		rk.append(777)
		rk.append(937)
		rk.append(272)
		rk.append(469)
		rk.append(446)
		rk.append(128)
		rk.append(229)
		rk.append(246)
		rk.append(284)
		rk.append(806)
		rk.append(712)
		rk.append(978)
		rk.append(329)
		rk.append(159)
		rk.append(318)
		rk.append(143)
		rk.append(241)
		rk.append(308)
		rk.append(859)
		rk.append(389)
		rk.append(529)
		rk.append(705)
		rk.append(440)
		rk.append(680)
		rk.append(174)
		rk.append(507)
		rk.append(330)
		rk.append(747)
		rk.append(220)
		rk.append(627)
		rk.append(969)
		rk.append(381)
		rk.append(653)
		rk.append(502)
		rk.append(970)
		rk.append(450)
		rk.append(846)
		rk.append(414)
		rk.append(832)
		rk.append(200)
		rk.append(858)
		rk.append(962)
		rk.append(597)
		rk.append(490)
		rk.append(941)
		rk.append(266)
		rk.append(183)
		rk.append(706)
		rk.append(514)
		rk.append(598)
		rk.append(887)
		rk.append(921)
		rk.append(454)
		rk.append(453)
		rk.append(460)
		rk.append(581)
		rk.append(161)
		rk.append(875)
		rk.append(272)
		rk.append(602)
		rk.append(698)
		rk.append(804)
		rk.append(348)
		rk.append(423)
		rk.append(424)
		rk.append(811)
		rk.append(550)
		rk.append(659)
		rk.append(279)
		rk.append(834)
		rk.append(831)
		rk.append(409)
		rk.append(277)
		rk.append(772)
		rk.append(787)
		rk.append(464)
		rk.append(492)
		rk.append(560)
		rk.append(605)
		rk.append(135)
		rk.append(875)
		rk.append(925)
		rk.append(356)
		rk.append(225)
		rk.append(989)
		rk.append(810)
		rk.append(471)
		rk.append(779)
		rk.append(290)
		rk.append(543)
		rk.append(432)
		rk.append(859)
		rk.append(590)
		rk.append(130)
		rk.append(950)
		rk.append(807)
		rk.append(486)
		rk.append(856)
		rk.append(812)
		rk.append(600)
		rk.append(812)
		rk.append(1000)
		rk.append(521)
		rk.append(816)
		rk.append(882)
		rk.append(265)
		rk.append(903)
		rk.append(639)
		rk.append(793)
		rk.append(247)
		rk.append(560)
		rk.append(922)
		rk.append(108)
		rk.append(638)
		rk.append(347)
		rk.append(786)
		rk.append(258)
		rk.append(634)
		rk.append(721)
		rk.append(397)
		rk.append(351)
		rk.append(855)
		rk.append(482)
		rk.append(243)
		rk.append(317)
		rk.append(888)
		rk.append(371)
		rk.append(342)
		rk.append(957)
		rk.append(515)
		rk.append(522)
		rk.append(967)
		rk.append(747)
		rk.append(157)
		rk.append(982)
		rk.append(198)
		rk.append(885)
		rk.append(713)
		rk.append(518)
		rk.append(667)
		rk.append(299)
		rk.append(584)
		rk.append(782)
		rk.append(306)
		rk.append(707)
		rk.append(674)
		rk.append(292)
		rk.append(308)
		rk.append(929)
		rk.append(944)
		rk.append(793)
		rk.append(557)
		rk.append(611)
		rk.append(467)
		rk.append(798)
		rk.append(626)
		rk.append(774)
		rk.append(431)
		rk.append(786)
		rk.append(546)
		rk.append(189)
		rk.append(158)
		rk.append(768)
		rk.append(484)
		rk.append(592)
		rk.append(902)
		rk.append(972)
		rk.append(618)
		rk.append(854)
		rk.append(407)
		rk.append(383)
		rk.append(547)
		rk.append(618)
		rk.append(388)
		rk.append(896)
		rk.append(536)
		rk.append(186)
		rk.append(232)
		rk.append(434)
		rk.append(196)
		rk.append(466)
		rk.append(613)
		rk.append(113)
		rk.append(371)
		rk.append(192)
		rk.append(773)
		rk.append(760)
		rk.append(815)
		rk.append(949)
		rk.append(406)
		rk.append(116)
		rk.append(330)
		rk.append(145)
		rk.append(343)
		rk.append(171)
		rk.append(182)
		rk.append(345)
		rk.append(703)
		rk.append(288)
		rk.append(939)
		rk.append(686)
		rk.append(460)
		rk.append(745)
		rk.append(791)
		rk.append(517)
		rk.append(125)
		rk.append(385)
		rk.append(124)
		rk.append(319)
		rk.append(238)
		rk.append(658)
		rk.append(596)
		rk.append(320)
		rk.append(616)
		rk.append(585)
		rk.append(304)
		rk.append(526)
		rk.append(777)
		rk.append(700)
		rk.append(360)
		rk.append(651)
		rk.append(738)
		rk.append(724)

	elif rank == 2:
		rk = []
		rk.append(222)
		rk.append(896)
		rk.append(721)
		rk.append(568)
		rk.append(723)
		rk.append(748)
		rk.append(598)
		rk.append(154)
		rk.append(177)
		rk.append(956)
		rk.append(328)
		rk.append(606)
		rk.append(557)
		rk.append(243)
		rk.append(535)
		rk.append(349)
		rk.append(906)
		rk.append(750)
		rk.append(909)
		rk.append(508)
		rk.append(386)
		rk.append(231)
		rk.append(873)
		rk.append(182)
		rk.append(795)
		rk.append(534)
		rk.append(173)
		rk.append(591)
		rk.append(472)
		rk.append(996)
		rk.append(437)
		rk.append(721)
		rk.append(965)
		rk.append(442)
		rk.append(129)
		rk.append(240)
		rk.append(475)
		rk.append(677)
		rk.append(640)
		rk.append(514)
		rk.append(954)
		rk.append(460)
		rk.append(402)
		rk.append(388)
		rk.append(767)
		rk.append(434)
		rk.append(895)
		rk.append(495)
		rk.append(894)
		rk.append(282)
		rk.append(742)
		rk.append(398)
		rk.append(117)
		rk.append(608)
		rk.append(175)
		rk.append(835)
		rk.append(263)
		rk.append(950)
		rk.append(409)
		rk.append(627)
		rk.append(635)
		rk.append(612)
		rk.append(300)
		rk.append(562)
		rk.append(383)
		rk.append(424)
		rk.append(448)
		rk.append(334)
		rk.append(608)
		rk.append(183)
		rk.append(800)
		rk.append(191)
		rk.append(734)
		rk.append(536)
		rk.append(709)
		rk.append(744)
		rk.append(322)
		rk.append(787)
		rk.append(898)
		rk.append(201)
		rk.append(344)
		rk.append(113)
		rk.append(420)
		rk.append(422)
		rk.append(513)
		rk.append(298)
		rk.append(241)
		rk.append(130)
		rk.append(659)
		rk.append(699)
		rk.append(981)
		rk.append(986)
		rk.append(521)
		rk.append(359)
		rk.append(596)
		rk.append(462)
		rk.append(529)
		rk.append(179)
		rk.append(183)
		rk.append(959)
		rk.append(685)
		rk.append(222)
		rk.append(363)
		rk.append(396)
		rk.append(607)
		rk.append(765)
		rk.append(482)
		rk.append(438)
		rk.append(897)
		rk.append(821)
		rk.append(948)
		rk.append(512)
		rk.append(931)
		rk.append(930)
		rk.append(618)
		rk.append(790)
		rk.append(443)
		rk.append(192)
		rk.append(930)
		rk.append(375)
		rk.append(346)
		rk.append(719)
		rk.append(127)
		rk.append(945)
		rk.append(686)
		rk.append(101)
		rk.append(698)
		rk.append(473)
		rk.append(521)
		rk.append(351)
		rk.append(471)
		rk.append(578)
		rk.append(268)
		rk.append(616)
		rk.append(618)
		rk.append(825)
		rk.append(840)
		rk.append(929)
		rk.append(727)
		rk.append(738)
		rk.append(645)
		rk.append(729)
		rk.append(831)
		rk.append(884)
		rk.append(374)
		rk.append(353)
		rk.append(815)
		rk.append(505)
		rk.append(975)
		rk.append(561)
		rk.append(451)
		rk.append(288)
		rk.append(179)
		rk.append(794)
		rk.append(195)
		rk.append(918)
		rk.append(761)
		rk.append(211)
		rk.append(815)
		rk.append(757)
		rk.append(277)
		rk.append(668)
		rk.append(369)
		rk.append(461)
		rk.append(950)
		rk.append(922)
		rk.append(360)
		rk.append(754)
		rk.append(340)
		rk.append(989)
		rk.append(267)
		rk.append(620)
		rk.append(499)
		rk.append(840)
		rk.append(159)
		rk.append(247)
		rk.append(118)
		rk.append(227)
		rk.append(711)
		rk.append(988)
		rk.append(393)
		rk.append(608)
		rk.append(149)
		rk.append(651)
		rk.append(125)
		rk.append(759)
		rk.append(512)
		rk.append(790)
		rk.append(387)
		rk.append(367)
		rk.append(108)
		rk.append(314)
		rk.append(205)
		rk.append(115)
		rk.append(994)
		rk.append(695)
		rk.append(652)
		rk.append(518)
		rk.append(899)
		rk.append(729)
		rk.append(106)
		rk.append(719)
		rk.append(832)
		rk.append(680)
		rk.append(318)
		rk.append(426)
		rk.append(486)
		rk.append(478)
		rk.append(472)
		rk.append(614)
		rk.append(326)
		rk.append(203)
		rk.append(894)
		rk.append(352)
		rk.append(329)
		rk.append(500)
		rk.append(821)
		rk.append(266)
		rk.append(823)
		rk.append(508)
		rk.append(133)
		rk.append(272)
		rk.append(916)
		rk.append(345)
		rk.append(200)
		rk.append(746)
		rk.append(654)
		rk.append(845)
		rk.append(680)
		rk.append(154)
		rk.append(739)
		rk.append(695)
		rk.append(261)
		rk.append(651)
		rk.append(715)
		rk.append(458)
		rk.append(631)
		rk.append(401)
		rk.append(888)
		rk.append(690)
		rk.append(200)
		rk.append(789)
		rk.append(521)
		rk.append(501)
		rk.append(159)
		rk.append(608)
		rk.append(546)
		rk.append(693)
		rk.append(962)
		rk.append(271)

	elif rank == 3:
		rk = []
		rk.append(504)
		rk.append(786)
		rk.append(498)
		rk.append(124)
		rk.append(265)
		rk.append(398)
		rk.append(198)
		rk.append(761)
		rk.append(613)
		rk.append(586)
		rk.append(436)
		rk.append(636)
		rk.append(853)
		rk.append(410)
		rk.append(580)
		rk.append(113)
		rk.append(463)
		rk.append(681)
		rk.append(343)
		rk.append(806)
		rk.append(838)
		rk.append(879)
		rk.append(895)
		rk.append(986)
		rk.append(974)
		rk.append(809)
		rk.append(913)
		rk.append(861)
		rk.append(514)
		rk.append(121)
		rk.append(326)
		rk.append(277)
		rk.append(303)
		rk.append(747)
		rk.append(507)
		rk.append(464)
		rk.append(128)
		rk.append(160)
		rk.append(874)
		rk.append(188)
		rk.append(225)
		rk.append(766)
		rk.append(200)
		rk.append(777)
		rk.append(747)
		rk.append(715)
		rk.append(855)
		rk.append(932)
		rk.append(806)
		rk.append(299)
		rk.append(542)
		rk.append(986)
		rk.append(646)
		rk.append(708)
		rk.append(408)
		rk.append(704)
		rk.append(863)
		rk.append(294)
		rk.append(620)
		rk.append(296)
		rk.append(928)
		rk.append(382)
		rk.append(331)
		rk.append(655)
		rk.append(734)
		rk.append(453)
		rk.append(348)
		rk.append(243)
		rk.append(734)
		rk.append(940)
		rk.append(652)
		rk.append(709)
		rk.append(573)
		rk.append(344)
		rk.append(908)
		rk.append(834)
		rk.append(128)
		rk.append(752)
		rk.append(412)
		rk.append(453)
		rk.append(437)
		rk.append(637)
		rk.append(388)
		rk.append(396)
		rk.append(358)
		rk.append(165)
		rk.append(941)
		rk.append(440)
		rk.append(541)
		rk.append(495)
		rk.append(940)
		rk.append(460)
		rk.append(985)
		rk.append(332)
		rk.append(113)
		rk.append(574)
		rk.append(477)
		rk.append(449)
		rk.append(568)
		rk.append(909)
		rk.append(355)
		rk.append(155)
		rk.append(176)
		rk.append(537)
		rk.append(315)
		rk.append(110)
		rk.append(298)
		rk.append(774)
		rk.append(515)
		rk.append(707)
		rk.append(167)
		rk.append(965)
		rk.append(236)
		rk.append(686)
		rk.append(927)
		rk.append(798)
		rk.append(642)
		rk.append(481)
		rk.append(324)
		rk.append(708)
		rk.append(344)
		rk.append(364)
		rk.append(208)
		rk.append(396)
		rk.append(462)
		rk.append(247)
		rk.append(225)
		rk.append(946)
		rk.append(228)
		rk.append(729)
		rk.append(121)
		rk.append(708)
		rk.append(700)
		rk.append(504)
		rk.append(585)
		rk.append(697)
		rk.append(115)
		rk.append(378)
		rk.append(220)
		rk.append(549)
		rk.append(708)
		rk.append(449)
		rk.append(508)
		rk.append(227)
		rk.append(752)
		rk.append(685)
		rk.append(355)
		rk.append(791)
		rk.append(354)
		rk.append(949)
		rk.append(792)
		rk.append(111)
		rk.append(989)
		rk.append(709)
		rk.append(818)
		rk.append(945)
		rk.append(694)
		rk.append(419)
		rk.append(463)
		rk.append(953)
		rk.append(851)
		rk.append(791)
		rk.append(531)
		rk.append(472)
		rk.append(591)
		rk.append(696)
		rk.append(259)
		rk.append(497)
		rk.append(450)
		rk.append(345)
		rk.append(305)
		rk.append(198)
		rk.append(339)
		rk.append(204)
		rk.append(930)
		rk.append(592)
		rk.append(661)
		rk.append(242)
		rk.append(869)
		rk.append(687)
		rk.append(319)
		rk.append(563)
		rk.append(372)
		rk.append(230)
		rk.append(685)
		rk.append(103)
		rk.append(732)
		rk.append(165)
		rk.append(740)
		rk.append(399)
		rk.append(181)
		rk.append(372)
		rk.append(203)
		rk.append(704)
		rk.append(101)
		rk.append(326)
		rk.append(377)
		rk.append(958)
		rk.append(821)
		rk.append(949)
		rk.append(489)
		rk.append(887)
		rk.append(897)
		rk.append(760)
		rk.append(270)
		rk.append(399)
		rk.append(791)
		rk.append(339)
		rk.append(135)
		rk.append(564)
		rk.append(365)
		rk.append(168)
		rk.append(451)
		rk.append(381)
		rk.append(607)
		rk.append(416)
		rk.append(816)
		rk.append(309)
		rk.append(217)
		rk.append(499)
		rk.append(891)
		rk.append(310)
		rk.append(413)
		rk.append(711)
		rk.append(147)
		rk.append(343)
		rk.append(564)
		rk.append(721)
		rk.append(465)
		rk.append(275)
		rk.append(342)
		rk.append(887)
		rk.append(930)
		rk.append(564)
		rk.append(961)
		rk.append(495)
		rk.append(382)
		rk.append(171)
		rk.append(917)
		rk.append(488)
		rk.append(546)
		rk.append(229)
		rk.append(815)
		rk.append(138)
		rk.append(113)
		rk.append(366)
		rk.append(321)
		rk.append(831)
		rk.append(341)
		rk.append(269)

	elif rank == 4:
		rk = []
		rk.append(120)
		rk.append(341)
		rk.append(622)
		rk.append(492)
		rk.append(643)
		rk.append(689)
		rk.append(582)
		rk.append(587)
		rk.append(759)
		rk.append(883)
		rk.append(148)
		rk.append(603)
		rk.append(888)
		rk.append(810)
		rk.append(531)
		rk.append(399)
		rk.append(554)
		rk.append(609)
		rk.append(799)
		rk.append(801)
		rk.append(253)
		rk.append(881)
		rk.append(156)
		rk.append(485)
		rk.append(128)
		rk.append(664)
		rk.append(994)
		rk.append(303)
		rk.append(676)
		rk.append(457)
		rk.append(360)
		rk.append(874)
		rk.append(365)
		rk.append(714)
		rk.append(522)
		rk.append(759)
		rk.append(468)
		rk.append(383)
		rk.append(180)
		rk.append(767)
		rk.append(446)
		rk.append(903)
		rk.append(294)
		rk.append(174)
		rk.append(834)
		rk.append(581)
		rk.append(170)
		rk.append(652)
		rk.append(277)
		rk.append(156)
		rk.append(148)
		rk.append(927)
		rk.append(512)
		rk.append(418)
		rk.append(775)
		rk.append(747)
		rk.append(481)
		rk.append(903)
		rk.append(785)
		rk.append(551)
		rk.append(166)
		rk.append(551)
		rk.append(295)
		rk.append(822)
		rk.append(492)
		rk.append(401)
		rk.append(232)
		rk.append(670)
		rk.append(353)
		rk.append(904)
		rk.append(667)
		rk.append(704)
		rk.append(148)
		rk.append(102)
		rk.append(757)
		rk.append(539)
		rk.append(567)
		rk.append(467)
		rk.append(546)
		rk.append(629)
		rk.append(229)
		rk.append(592)
		rk.append(285)
		rk.append(149)
		rk.append(478)
		rk.append(189)
		rk.append(549)
		rk.append(501)
		rk.append(202)
		rk.append(748)
		rk.append(442)
		rk.append(850)
		rk.append(565)
		rk.append(973)
		rk.append(345)
		rk.append(738)
		rk.append(312)
		rk.append(735)
		rk.append(956)
		rk.append(105)
		rk.append(857)
		rk.append(373)
		rk.append(599)
		rk.append(372)
		rk.append(304)
		rk.append(315)
		rk.append(765)
		rk.append(978)
		rk.append(188)
		rk.append(634)
		rk.append(861)
		rk.append(820)
		rk.append(782)
		rk.append(302)
		rk.append(652)
		rk.append(373)
		rk.append(861)
		rk.append(101)
		rk.append(583)
		rk.append(197)
		rk.append(169)
		rk.append(692)
		rk.append(484)
		rk.append(325)
		rk.append(401)
		rk.append(316)
		rk.append(766)
		rk.append(417)
		rk.append(491)
		rk.append(689)
		rk.append(351)
		rk.append(683)
		rk.append(130)
		rk.append(938)
		rk.append(458)
		rk.append(473)
		rk.append(883)
		rk.append(847)
		rk.append(430)
		rk.append(922)
		rk.append(939)
		rk.append(264)
		rk.append(212)
		rk.append(560)
		rk.append(446)
		rk.append(283)
		rk.append(718)
		rk.append(856)
		rk.append(738)
		rk.append(907)
		rk.append(533)
		rk.append(614)
		rk.append(648)
		rk.append(559)
		rk.append(562)
		rk.append(655)
		rk.append(594)
		rk.append(362)
		rk.append(845)
		rk.append(148)
		rk.append(421)
		rk.append(426)
		rk.append(111)
		rk.append(433)
		rk.append(479)
		rk.append(513)
		rk.append(265)
		rk.append(523)
		rk.append(606)
		rk.append(471)
		rk.append(326)
		rk.append(428)
		rk.append(611)
		rk.append(439)
		rk.append(126)
		rk.append(789)
		rk.append(159)
		rk.append(520)
		rk.append(976)
		rk.append(878)
		rk.append(737)
		rk.append(114)
		rk.append(907)
		rk.append(535)
		rk.append(651)
		rk.append(992)
		rk.append(733)
		rk.append(284)
		rk.append(744)
		rk.append(832)
		rk.append(672)
		rk.append(321)
		rk.append(305)
		rk.append(491)
		rk.append(277)
		rk.append(187)
		rk.append(382)
		rk.append(261)
		rk.append(721)
		rk.append(942)
		rk.append(448)
		rk.append(539)
		rk.append(190)
		rk.append(748)
		rk.append(935)
		rk.append(643)
		rk.append(949)
		rk.append(418)
		rk.append(556)
		rk.append(387)
		rk.append(922)
		rk.append(120)
		rk.append(752)
		rk.append(322)
		rk.append(599)
		rk.append(714)
		rk.append(637)
		rk.append(219)
		rk.append(242)
		rk.append(715)
		rk.append(986)
		rk.append(662)
		rk.append(974)
		rk.append(606)
		rk.append(133)
		rk.append(354)
		rk.append(795)
		rk.append(668)
		rk.append(562)
		rk.append(418)
		rk.append(423)
		rk.append(841)
		rk.append(724)
		rk.append(596)
		rk.append(358)
		rk.append(293)
		rk.append(961)
		rk.append(413)
		rk.append(687)
		rk.append(944)
		rk.append(153)
		rk.append(905)
		rk.append(144)
		rk.append(438)
		rk.append(414)
		rk.append(965)
		rk.append(946)
		rk.append(745)
		rk.append(515)
		rk.append(834)

	bubblesort(rk)
	print(rk)
	print "Rank %d" %(rank)
	comm.send(rk, dest=0)
